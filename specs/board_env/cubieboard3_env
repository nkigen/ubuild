#!/bin/bash

_SPEC_DIR=$(dirname "${UBUILD_SPEC_PATH}")

# Linux kernel configuration, either set KERNEL_DEFCONFIG or KERNEL_CONFIG
KERNEL_DEFCONFIG="omap2plus_defconfig"
KERNEL_CONFIG=""
KERNEL_MD5="-" # $(md5sum "${KERNEL_CONFIG}")
if [ -z "${KERNEL_MD5}" ]; then
    exit 1
fi

export KERNEL_DEFCONFIG KERNEL_CONFIG KERNEL_MD5

UBOOT_DEFCONFIG="omap3_beagle_config"
UBOOT_RAMDISK_ADDRESS="0x48000000"
UBOOT_RAMDISK_ENTRYPOINT="0x43000000"
UBOOT_KERNEL_ADDRESS="0x47000000"
UBOOT_KERNEL_ENTRYPOINT="${UBOOT_KERNEL_ADDRESS}"
UBOOT_IMAGE_NAME="u-boot.img"
IMAGE_TTY_DEV="/dev/ttyS0"
IMAGE_SIZE_MB="512"
UBOOT_UENV="${_SPEC_DIR}/boot/cubieboard3.uEnv.txt"
if [ ! -e "${UBOOT_UENV}" ]; then
    echo "${UBOOT_UENV} not found" >&2
    exit 1
fi

IMAGE_INITRAMFS_MODULES="usb-storage sha256_generic cbc aes_generic xts"
export IMAGE_INITRAMFS_MODULES

export UBOOT_DEFCONFIG UBOOT_UENV UBOOT_IMAGE_NAME
export UBOOT_RAMDISK_ADDRESS UBOOT_RAMDISK_ENTRYPOINT
export UBOOT_KERNEL_ADDRESS UBOOT_KERNEL_ENTRYPOINT
export IMAGE_TTY_DEV IMAGE_SIZE_MB
